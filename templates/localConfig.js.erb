{
  port: "<%= scope.lookupvar('statsd::port') %>"
, address: "<%= scope.lookupvar('statsd::address') %>"
, backends: [<% scope.lookupvar('statsd::backends').each do |backend| -%>
  "<%= backend %>",
  <% end -%>]

, debug: <%= scope.lookupvar('statsd::debug') %>
, mgmt_address: "<%= scope.lookupvar('statsd::mgmt_address') %>"
, mgmt_port: "<%= scope.lookupvar('statsd::mgmt_port') %>"
, title: "<%= scope.lookupvar('statsd::statsd_title') %>"
, healthStatus: "<%= scope.lookupvar('statsd::healthStatus') %>"
, dumpMessages: <%= scope.lookupvar('statsd::dumpMessages') %>
, flushInterval: "<%= scope.lookupvar('statsd::flushInterval') %>"
, percentThreshold: [<%= scope.lookupvar('statsd::percentThreshold').join(', ') %>]
, flush_counts: <%= scope.lookupvar('statsd::flush_counts') %>

<% if scope.lookupvar('statsd::backends').grep(/graphite/).any? -%>
, graphitePort: "<%= scope.lookupvar('statsd::graphitePort') %>"
, graphiteHost: "<%= scope.lookupvar('statsd::graphiteHost') %>"
, graphite: {
    legacyNamespace:  <%= scope.lookupvar('statsd::graphite_legacyNamespace') %>,
    globalPrefix:     "<%= scope.lookupvar('statsd::graphite_globalPrefix') %>",
    prefixCounter:    "<%= scope.lookupvar('statsd::graphite_prefixCounter') %>",
    prefixTimer:      "<%= scope.lookupvar('statsd::graphite_prefixTimer') %>",
    prefixGauge:      "<%= scope.lookupvar('statsd::graphite_prefixGauge') %>",
  <%- if defined? scope.lookupvar('statsd::graphite_globalSuffix') -%>
    prefixSet:        "<%= scope.lookupvar('statsd::graphite_prefixSet') %>",
    globalSuffix:     "<%= scope.lookupvar('statsd::graphite_globalSuffix') %>"
  <%- else -%>
    prefixSet:        "<%= scope.lookupvar('statsd::graphite_prefixSet') %>"
  <%- end -%>
  }
<% end -%>

<% if scope.lookupvar('statsd::backends').grep(/influxdb/).any? -%>
, influxdb: {
    host: "<%= scope.lookupvar('statsd::influxdb_host') %>",
    port: <%= scope.lookupvar('statsd::influxdb_port') %>,
    database: "<%= scope.lookupvar('statsd::influxdb_database') %>",
    username: "<%= scope.lookupvar('statsd::influxdb_username') %>",
    password: "<%= scope.lookupvar('statsd::influxdb_password') %>",
    flush: {
      enable: <%= scope.lookupvar('statsd::influxdb_flush') %>
    },
    proxy: {
      enable: <%= scope.lookupvar('statsd::influxdb_proxy') %>,
      suffix: "<%= scope.lookupvar('statsd::influxdb_proxy_suffix') %>",
      flushInterval: "<%= scope.lookupvar('statsd::influxdb_proxy_flushInterval') %>"
    }
  }
<% end -%>

<% if scope.lookupvar('statsd::backends').grep(/librato/).any? -%>
, librato: {
    email: "<%= scope.lookupvar('statsd::librato_email') %>",
    token: "<%= scope.lookupvar('statsd::librato_token') %>",
    snapTime: "<%= scope.lookupvar('statsd::librato_snapTime') %>",
    countersAsGauges: "<%= scope.lookupvar('statsd::librato_countersAsGauges') %>",
    skipInternalMetrics: "<%= scope.lookupvar('statsd::librato_skipInternalMetrics') %>",
    retryDelaySecs: "<%= scope.lookupvar('statsd::librato_retryDelaySecs') %>",
    postTimeoutSecs: "<%= scope.lookupvar('statsd::librato_postTimeoutSecs') %>"
  }
<% end -%>

<% if scope.lookupvar('statsd::backends').grep(/stackdriver/).any? -%>
, stackdriver: {
    apiKey: "<%= scope.lookupvar('statsd::stackdriver_apiKey') %>",
    source: "<%= scope.lookupvar('statsd::stackdriver_source') %>",
    sourceFromPrefix: "<%= scope.lookupvar('statsd::stackdriver_sourceFromPrefix') %>",
    sourcePrefixSeparator: "<%= scope.lookupvar('statsd::stackdriver_sourcePrefixSeparator') %>",
    sendTimerPercentiles: "<%= scope.lookupvar('statsd::stackdriver_sendTimerPercentiles') %>",
    debug: "<%= scope.lookupvar('statsd::stackdriver_debug') %>"
  }
<% end -%>

<% scope.lookupvar('statsd::config').each do |k, v| -%>
, <%= k %>: <%= v %>
<% end -%>
}
